{"ast":null,"code":"'use strict';\n\nconst {\n  AbstractIterator,\n  AbstractKeyIterator,\n  AbstractValueIterator\n} = require('../abstract-iterator');\n\nconst kUnfix = Symbol('unfix');\nconst kIterator = Symbol('iterator');\nconst kHandleOne = Symbol('handleOne');\nconst kHandleMany = Symbol('handleMany');\nconst kCallback = Symbol('callback'); // TODO: unfix natively if db supports it\n\nclass AbstractSublevelIterator extends AbstractIterator {\n  constructor(db, options, iterator, unfix) {\n    super(db, options);\n    this[kIterator] = iterator;\n    this[kUnfix] = unfix;\n    this[kHandleOne] = this[kHandleOne].bind(this);\n    this[kHandleMany] = this[kHandleMany].bind(this);\n    this[kCallback] = null;\n  }\n\n  [kHandleOne](err, key, value) {\n    const callback = this[kCallback];\n    if (err) return callback(err);\n    if (key !== undefined) key = this[kUnfix](key);\n    callback(err, key, value);\n  }\n\n  [kHandleMany](err, entries) {\n    const callback = this[kCallback];\n    if (err) return callback(err);\n\n    for (const entry of entries) {\n      const key = entry[0];\n      if (key !== undefined) entry[0] = this[kUnfix](key);\n    }\n\n    callback(err, entries);\n  }\n\n}\n\nclass AbstractSublevelKeyIterator extends AbstractKeyIterator {\n  constructor(db, options, iterator, unfix) {\n    super(db, options);\n    this[kIterator] = iterator;\n    this[kUnfix] = unfix;\n    this[kHandleOne] = this[kHandleOne].bind(this);\n    this[kHandleMany] = this[kHandleMany].bind(this);\n    this[kCallback] = null;\n  }\n\n  [kHandleOne](err, key) {\n    const callback = this[kCallback];\n    if (err) return callback(err);\n    if (key !== undefined) key = this[kUnfix](key);\n    callback(err, key);\n  }\n\n  [kHandleMany](err, keys) {\n    const callback = this[kCallback];\n    if (err) return callback(err);\n\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i];\n      if (key !== undefined) keys[i] = this[kUnfix](key);\n    }\n\n    callback(err, keys);\n  }\n\n}\n\nclass AbstractSublevelValueIterator extends AbstractValueIterator {\n  constructor(db, options, iterator) {\n    super(db, options);\n    this[kIterator] = iterator;\n  }\n\n}\n\nfor (const Iterator of [AbstractSublevelIterator, AbstractSublevelKeyIterator]) {\n  Iterator.prototype._next = function (callback) {\n    this[kCallback] = callback;\n    this[kIterator].next(this[kHandleOne]);\n  };\n\n  Iterator.prototype._nextv = function (size, options, callback) {\n    this[kCallback] = callback;\n    this[kIterator].nextv(size, options, this[kHandleMany]);\n  };\n\n  Iterator.prototype._all = function (options, callback) {\n    this[kCallback] = callback;\n    this[kIterator].all(options, this[kHandleMany]);\n  };\n}\n\nfor (const Iterator of [AbstractSublevelValueIterator]) {\n  Iterator.prototype._next = function (callback) {\n    this[kIterator].next(callback);\n  };\n\n  Iterator.prototype._nextv = function (size, options, callback) {\n    this[kIterator].nextv(size, options, callback);\n  };\n\n  Iterator.prototype._all = function (options, callback) {\n    this[kIterator].all(options, callback);\n  };\n}\n\nfor (const Iterator of [AbstractSublevelIterator, AbstractSublevelKeyIterator, AbstractSublevelValueIterator]) {\n  Iterator.prototype._seek = function (target, options) {\n    this[kIterator].seek(target, options);\n  };\n\n  Iterator.prototype._close = function (callback) {\n    this[kIterator].close(callback);\n  };\n}\n\nexports.AbstractSublevelIterator = AbstractSublevelIterator;\nexports.AbstractSublevelKeyIterator = AbstractSublevelKeyIterator;\nexports.AbstractSublevelValueIterator = AbstractSublevelValueIterator;","map":{"version":3,"sources":["C:/Users/Akshay Mishra/OneDrive/Desktop/twitter-clone-dapp/node_modules/abstract-level/lib/abstract-sublevel-iterator.js"],"names":["AbstractIterator","AbstractKeyIterator","AbstractValueIterator","require","kUnfix","Symbol","kIterator","kHandleOne","kHandleMany","kCallback","AbstractSublevelIterator","constructor","db","options","iterator","unfix","bind","err","key","value","callback","undefined","entries","entry","AbstractSublevelKeyIterator","keys","i","length","AbstractSublevelValueIterator","Iterator","prototype","_next","next","_nextv","size","nextv","_all","all","_seek","target","seek","_close","close","exports"],"mappings":"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","sourcesContent":["'use strict'\n\nconst { AbstractIterator, AbstractKeyIterator, AbstractValueIterator } = require('../abstract-iterator')\n\nconst kUnfix = Symbol('unfix')\nconst kIterator = Symbol('iterator')\nconst kHandleOne = Symbol('handleOne')\nconst kHandleMany = Symbol('handleMany')\nconst kCallback = Symbol('callback')\n\n// TODO: unfix natively if db supports it\nclass AbstractSublevelIterator extends AbstractIterator {\n  constructor (db, options, iterator, unfix) {\n    super(db, options)\n\n    this[kIterator] = iterator\n    this[kUnfix] = unfix\n    this[kHandleOne] = this[kHandleOne].bind(this)\n    this[kHandleMany] = this[kHandleMany].bind(this)\n    this[kCallback] = null\n  }\n\n  [kHandleOne] (err, key, value) {\n    const callback = this[kCallback]\n    if (err) return callback(err)\n    if (key !== undefined) key = this[kUnfix](key)\n    callback(err, key, value)\n  }\n\n  [kHandleMany] (err, entries) {\n    const callback = this[kCallback]\n    if (err) return callback(err)\n\n    for (const entry of entries) {\n      const key = entry[0]\n      if (key !== undefined) entry[0] = this[kUnfix](key)\n    }\n\n    callback(err, entries)\n  }\n}\n\nclass AbstractSublevelKeyIterator extends AbstractKeyIterator {\n  constructor (db, options, iterator, unfix) {\n    super(db, options)\n\n    this[kIterator] = iterator\n    this[kUnfix] = unfix\n    this[kHandleOne] = this[kHandleOne].bind(this)\n    this[kHandleMany] = this[kHandleMany].bind(this)\n    this[kCallback] = null\n  }\n\n  [kHandleOne] (err, key) {\n    const callback = this[kCallback]\n    if (err) return callback(err)\n    if (key !== undefined) key = this[kUnfix](key)\n    callback(err, key)\n  }\n\n  [kHandleMany] (err, keys) {\n    const callback = this[kCallback]\n    if (err) return callback(err)\n\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i]\n      if (key !== undefined) keys[i] = this[kUnfix](key)\n    }\n\n    callback(err, keys)\n  }\n}\n\nclass AbstractSublevelValueIterator extends AbstractValueIterator {\n  constructor (db, options, iterator) {\n    super(db, options)\n    this[kIterator] = iterator\n  }\n}\n\nfor (const Iterator of [AbstractSublevelIterator, AbstractSublevelKeyIterator]) {\n  Iterator.prototype._next = function (callback) {\n    this[kCallback] = callback\n    this[kIterator].next(this[kHandleOne])\n  }\n\n  Iterator.prototype._nextv = function (size, options, callback) {\n    this[kCallback] = callback\n    this[kIterator].nextv(size, options, this[kHandleMany])\n  }\n\n  Iterator.prototype._all = function (options, callback) {\n    this[kCallback] = callback\n    this[kIterator].all(options, this[kHandleMany])\n  }\n}\n\nfor (const Iterator of [AbstractSublevelValueIterator]) {\n  Iterator.prototype._next = function (callback) {\n    this[kIterator].next(callback)\n  }\n\n  Iterator.prototype._nextv = function (size, options, callback) {\n    this[kIterator].nextv(size, options, callback)\n  }\n\n  Iterator.prototype._all = function (options, callback) {\n    this[kIterator].all(options, callback)\n  }\n}\n\nfor (const Iterator of [AbstractSublevelIterator, AbstractSublevelKeyIterator, AbstractSublevelValueIterator]) {\n  Iterator.prototype._seek = function (target, options) {\n    this[kIterator].seek(target, options)\n  }\n\n  Iterator.prototype._close = function (callback) {\n    this[kIterator].close(callback)\n  }\n}\n\nexports.AbstractSublevelIterator = AbstractSublevelIterator\nexports.AbstractSublevelKeyIterator = AbstractSublevelKeyIterator\nexports.AbstractSublevelValueIterator = AbstractSublevelValueIterator\n"]},"metadata":{},"sourceType":"script"}