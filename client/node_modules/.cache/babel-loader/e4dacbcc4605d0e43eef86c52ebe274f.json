{"ast":null,"code":"const RateLimiterAbstract = require('./RateLimiterAbstract');\n\nmodule.exports = class RateLimiterUnion {\n  constructor() {\n    for (var _len = arguments.length, limiters = new Array(_len), _key = 0; _key < _len; _key++) {\n      limiters[_key] = arguments[_key];\n    }\n\n    if (limiters.length < 1) {\n      throw new Error('RateLimiterUnion: at least one limiter have to be passed');\n    }\n\n    limiters.forEach(limiter => {\n      if (!(limiter instanceof RateLimiterAbstract)) {\n        throw new Error('RateLimiterUnion: all limiters have to be instance of RateLimiterAbstract');\n      }\n    });\n    this._limiters = limiters;\n  }\n\n  consume(key) {\n    let points = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    return new Promise((resolve, reject) => {\n      const promises = [];\n\n      this._limiters.forEach(limiter => {\n        promises.push(limiter.consume(key, points).catch(rej => ({\n          rejected: true,\n          rej\n        })));\n      });\n\n      Promise.all(promises).then(res => {\n        const resObj = {};\n        let rejected = false;\n        res.forEach(item => {\n          if (item.rejected === true) {\n            rejected = true;\n          }\n        });\n\n        for (let i = 0; i < res.length; i++) {\n          if (rejected && res[i].rejected === true) {\n            resObj[this._limiters[i].keyPrefix] = res[i].rej;\n          } else if (!rejected) {\n            resObj[this._limiters[i].keyPrefix] = res[i];\n          }\n        }\n\n        if (rejected) {\n          reject(resObj);\n        } else {\n          resolve(resObj);\n        }\n      });\n    });\n  }\n\n};","map":{"version":3,"sources":["C:/Users/Akshay Mishra/OneDrive/Desktop/twitter-clone-dapp/node_modules/rate-limiter-flexible/lib/RateLimiterUnion.js"],"names":["RateLimiterAbstract","require","module","exports","RateLimiterUnion","constructor","limiters","length","Error","forEach","limiter","_limiters","consume","key","points","Promise","resolve","reject","promises","push","catch","rej","rejected","all","then","res","resObj","item","i","keyPrefix"],"mappings":"AAAA,MAAMA,mBAAmB,GAAGC,OAAO,CAAC,uBAAD,CAAnC;;AAEAC,MAAM,CAACC,OAAP,GAAiB,MAAMC,gBAAN,CAAuB;AACtCC,EAAAA,WAAW,GAAc;AAAA,sCAAVC,QAAU;AAAVA,MAAAA,QAAU;AAAA;;AACvB,QAAIA,QAAQ,CAACC,MAAT,GAAkB,CAAtB,EAAyB;AACvB,YAAM,IAAIC,KAAJ,CAAU,0DAAV,CAAN;AACD;;AACDF,IAAAA,QAAQ,CAACG,OAAT,CAAkBC,OAAD,IAAa;AAC5B,UAAI,EAAEA,OAAO,YAAYV,mBAArB,CAAJ,EAA+C;AAC7C,cAAM,IAAIQ,KAAJ,CAAU,2EAAV,CAAN;AACD;AACF,KAJD;AAMA,SAAKG,SAAL,GAAiBL,QAAjB;AACD;;AAEDM,EAAAA,OAAO,CAACC,GAAD,EAAkB;AAAA,QAAZC,MAAY,uEAAH,CAAG;AACvB,WAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,YAAMC,QAAQ,GAAG,EAAjB;;AACA,WAAKP,SAAL,CAAeF,OAAf,CAAwBC,OAAD,IAAa;AAClCQ,QAAAA,QAAQ,CAACC,IAAT,CAAcT,OAAO,CAACE,OAAR,CAAgBC,GAAhB,EAAqBC,MAArB,EAA6BM,KAA7B,CAAmCC,GAAG,KAAK;AAAEC,UAAAA,QAAQ,EAAE,IAAZ;AAAkBD,UAAAA;AAAlB,SAAL,CAAtC,CAAd;AACD,OAFD;;AAIAN,MAAAA,OAAO,CAACQ,GAAR,CAAYL,QAAZ,EACGM,IADH,CACSC,GAAD,IAAS;AACb,cAAMC,MAAM,GAAG,EAAf;AACA,YAAIJ,QAAQ,GAAG,KAAf;AAEAG,QAAAA,GAAG,CAAChB,OAAJ,CAAakB,IAAD,IAAU;AACpB,cAAIA,IAAI,CAACL,QAAL,KAAkB,IAAtB,EAA4B;AAC1BA,YAAAA,QAAQ,GAAG,IAAX;AACD;AACF,SAJD;;AAMA,aAAK,IAAIM,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,GAAG,CAAClB,MAAxB,EAAgCqB,CAAC,EAAjC,EAAqC;AACnC,cAAIN,QAAQ,IAAIG,GAAG,CAACG,CAAD,CAAH,CAAON,QAAP,KAAoB,IAApC,EAA0C;AACxCI,YAAAA,MAAM,CAAC,KAAKf,SAAL,CAAeiB,CAAf,EAAkBC,SAAnB,CAAN,GAAsCJ,GAAG,CAACG,CAAD,CAAH,CAAOP,GAA7C;AACD,WAFD,MAEO,IAAI,CAACC,QAAL,EAAe;AACpBI,YAAAA,MAAM,CAAC,KAAKf,SAAL,CAAeiB,CAAf,EAAkBC,SAAnB,CAAN,GAAsCJ,GAAG,CAACG,CAAD,CAAzC;AACD;AACF;;AAED,YAAIN,QAAJ,EAAc;AACZL,UAAAA,MAAM,CAACS,MAAD,CAAN;AACD,SAFD,MAEO;AACLV,UAAAA,OAAO,CAACU,MAAD,CAAP;AACD;AACF,OAxBH;AAyBD,KA/BM,CAAP;AAgCD;;AA/CqC,CAAxC","sourcesContent":["const RateLimiterAbstract = require('./RateLimiterAbstract');\n\nmodule.exports = class RateLimiterUnion {\n  constructor(...limiters) {\n    if (limiters.length < 1) {\n      throw new Error('RateLimiterUnion: at least one limiter have to be passed');\n    }\n    limiters.forEach((limiter) => {\n      if (!(limiter instanceof RateLimiterAbstract)) {\n        throw new Error('RateLimiterUnion: all limiters have to be instance of RateLimiterAbstract');\n      }\n    });\n\n    this._limiters = limiters;\n  }\n\n  consume(key, points = 1) {\n    return new Promise((resolve, reject) => {\n      const promises = [];\n      this._limiters.forEach((limiter) => {\n        promises.push(limiter.consume(key, points).catch(rej => ({ rejected: true, rej })));\n      });\n\n      Promise.all(promises)\n        .then((res) => {\n          const resObj = {};\n          let rejected = false;\n\n          res.forEach((item) => {\n            if (item.rejected === true) {\n              rejected = true;\n            }\n          });\n\n          for (let i = 0; i < res.length; i++) {\n            if (rejected && res[i].rejected === true) {\n              resObj[this._limiters[i].keyPrefix] = res[i].rej;\n            } else if (!rejected) {\n              resObj[this._limiters[i].keyPrefix] = res[i];\n            }\n          }\n\n          if (rejected) {\n            reject(resObj);\n          } else {\n            resolve(resObj);\n          }\n        });\n    });\n  }\n};\n"]},"metadata":{},"sourceType":"script"}